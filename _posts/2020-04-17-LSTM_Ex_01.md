---
title: "LSTM Exercise #01 - Airplane Passengers Prediction"
date: 2020-04-14 08:26:28 -0400
categories: DeepLearning LSTM
---
# LSTM Exercise #01 - Airplane Passengers Prediction

<br>
<br>
<br>

* 이번 예제에서는 LSTM을 이용하여 비행기 승객수 예측을 해 보도록 하겠습니다.

* 비교적 Data가 적지만, 예제로 사용하기에는 충분하다고 생각합니다.

<br>
<br>
<br>
<br>
<br>
<br>

## 0. 준비

* 필요한 Package들을 Load하고, 이런저런 설정을 합니다.

* 늘 그렇듯 Keras & Tensorflow를 사용하도록 하겠습니다.   

<br>
<br>
<br>

```python
#-*- coding: CP949 -*-
%matplotlib inline
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

import warnings
warnings.filterwarnings('ignore')

import matplotlib
from IPython.display import set_matplotlib_formats

matplotlib.rc('font', family='Malgun Gothic')

matplotlib.rc('axes', unicode_minus=False)

set_matplotlib_formats('retina')

from IPython.core.interactiveshell import InteractiveShell
InteractiveShell.ast_node_interactivity = "all"

%config IPCompleter.greedy=True

import matplotlib.pyplot as plt
import math
import numpy as np
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error

from keras.preprocessing.sequence import TimeseriesGenerator
```

    Using TensorFlow backend.
    
<br>
<br>
<br>
<br>
<br>
<br>

* 우리가 사용할 Data를 Load하겠습니다.

* Download하실 분은 아래 Link를 참조해 주시기 바랍니다.
  - https://github.com/MoonLight314/Data/blob/master/airline-passengers.csv

* Pandas가 CSV 읽기가 쉽기 때문에 먼저 Pandas로 Load합니다.


```python
dataframe = pd.read_csv('airline-passengers.csv', usecols=[1], engine='python')
```

<br>
<br>
<br>

* 총 144개의 Data가 있고, 승객수를 저장한 하나의 Column만 있는 Simple한 Data입니다.


```python
dataframe.head()
dataframe.tail()
dataframe.info()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>passengers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>112</td>
    </tr>
    <tr>
      <td>1</td>
      <td>118</td>
    </tr>
    <tr>
      <td>2</td>
      <td>132</td>
    </tr>
    <tr>
      <td>3</td>
      <td>129</td>
    </tr>
    <tr>
      <td>4</td>
      <td>121</td>
    </tr>
  </tbody>
</table>
</div>






<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>passengers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>139</td>
      <td>606</td>
    </tr>
    <tr>
      <td>140</td>
      <td>508</td>
    </tr>
    <tr>
      <td>141</td>
      <td>461</td>
    </tr>
    <tr>
      <td>142</td>
      <td>390</td>
    </tr>
    <tr>
      <td>143</td>
      <td>432</td>
    </tr>
  </tbody>
</table>
</div>



    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 144 entries, 0 to 143
    Data columns (total 1 columns):
    passengers    144 non-null int64
    dtypes: int64(1)
    memory usage: 1.2 KB
    
    
