---
title: "RNN(Recurrent Neural Network)"
date: 2020-04-02 08:26:28 -0400
categories: DeepLearning RNN
---

# RNN( Recurrent Neural Network )
<br>
<br>
<br>
<br>
<br>   

* 이번 Post에서는 RNN(Recurrent Neural Network)에 대해서 다루어 보도록 하겠습니다.
* 주된 내용은 Standford 강의자료([CS231n 강좌](http://cs231n.stanford.edu/syllabus.html) )를 참고하였습니다.
* Sequence Data는 다음과 같은 특징을 가집니다.
     - 음악 , 영상 , 문장 , 날씨 , 주가 등은 각각의 Data가 개별적이 아닌, 연속적인 Data(Sequence Data)라는 점입니다.
     - 앞쪽의 Data가 뒤쪽의 Data에 영향을 준다는 의미입니다.  
     
     
* RNN 이외의 다른 ML / DL 기법이 이런 Sequence Data를 다루려면, Sequence가 가지는 전체적인 흐름을 하나의 Data 형태로 표현해야만 합니다.  

* 그래서, ML(Machine Learning) / NN(Neural Net) / CNN(Convolution Neural Net)은 이런 속성의 Data를 다루기 어렵습니다.
* Sequence Data를 처리할 때는 이전의 결과가 현재의 결과에 영향을 미칠 수 있어야 하며, 이런 Sequence 형태의 Data를 다룰 수 있는 Neural Net의 형태가 RNN입니다.

<br>
<br>
<br>
<br>
<br>


### 0. RNN의 기본 구조   

   

#### 다음은 RNN Cell의 기본 구조를 나타냅니다.   
<br>
<br>
<br>

<p align="center">
  <img src="/assets/RNN_Doc_Img/pic_00.png">
</p>

<br>
<br>
<br>   

* 위의 형태가 RNN의 기본적인 Cell을 나타냅니다.
* 입력(X<sub>t</sub>)을 받아서 어떤 연산을 거친 후 출력(h<sub>t</sub>)를 내보내는 구조는 일반 Perceptron의 동작과 동일합니다.
* <span style="color:red">다른점이 있다면, 출력이 하나 더 있고, 그 출력이 다시 입력으로 들어온다는 점입니다.</span>
* 이를 이해하기 쉽게 옆으로 펼쳐보겠습니다.

<br>
<br>
<br>

<p align="center">
  <img src="/assets/RNN_Doc_Img/pic_01.png">
</p>

<br>
<br>
<br>

* 위의 오른쪽 그림과 같이 Cell을 펼쳐보면, Cell의 출력이 다음 Cell의 입력으로 들어가는 모습을 볼 수 있습니다.
* 즉, **이전의 결과가 현재의 출력에 영향을 미친다는 것**을 뜻하며, 이것이 Recurrent의 의미이기도 합니다.

<br>
<br>
<br>   

   

* 이를 수식으로 살펴보면 아래와 같습니다.

<br>
<br>
<br>   

<p align="center">
  <img src="/assets/RNN_Doc_Img/pic_02.png">
</p>
   
<br>
<br>
<br>   
   

* 이를 수식으로 살펴보면, 위와 같이 New State는 이전 State와 현재의 입력의 함수로 표현됩니다.
* RNN에서 Function(F<sub>w</sub>)는 모든 RNN에 대해서 동일하며, 주로 tanh을 사용합니다.

   
<br>
<br>
<br>   
   
<br>
<br>
<br>   
   

   

### 1. Calculating Values

#### RNN에서 각각의 값들이 구해지는 과정을 수식으로 살펴보도록 하겠습니다.

   

   

   

* 우선 다음 Cell의 출력으로 나갈 h<sub>t</sub>값은 아래와 같이 계산합니다.   
<br>
<br>
<br>

<p align="center">
  <img src="/assets/RNN_Doc_Img/pic_03.png">
</p>
<br>
<br>
<br>

다음 State로 넘길 값은 현재의 입력(x<sub>t</sub>)와 이전 Cell에서 전달된 값(h<sub>t-1</sub>)으로 정해집니다.

   

위의 수식을 풀어쓰면 아래와 같이 쓸 수 있습니다.

<br>
<br>
<br>


<p align="center">
  <img src="/assets/RNN_Doc_Img/pic_04.png">
</p>
<br>
<br>
<br>


W<sub>hh</sub>와 W<sub>xh</sub>는 각 출력을 뽑아낼 때 사용한 Weight입니다.

   
<br>
<br>
<br>

   

해당 Cell의 출력을 계산할 때는 아래와 같은 수식으로 계산됩니다.

   
<br>
<br>
<br>

<p align="center">
  <img src="/assets/RNN_Doc_Img/pic_05.png">
</p>
   
<br>
<br>
<br>

* 해당 Cell의 출력을 뽑아낼 때는 W<sub>hy</sub> Weight를 사용합니다.  
* 위 수식에서 알 수 있듯이 각각의 값에 적용되는 Weight가 모두 다릅니다.

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

### 2. Example - Character Level Simple Language Model

* 간단한 예제를 통해서 RNN이 어떤 식으로 동작하는지 살펴보도록 하겠습니다.
* 실제 동작하는 Code가 아니라, 개념만 도식적으로 살펴보겠습니다.

#### Example Training Sequence

## 'hello'

* 우리가 학습하고자 하는 단어는 'hello'입니다.
* 첫 입력 문자로 'h'를 입력하면 'ello'가 출력되도록 하는 Model을 학습하고자 한다고 가정해 봅시다.
  
  
* Train에 사용될 문자의 종류는 **h, e, l, o** 이렇게 4개 입니다.

   
<br>
<br>
<br>
   

* 아래와 같은 구조가 되겠죠 
<br>
<br>
<br>

<p align="center">
  <img src="/assets/RNN_Doc_Img/pic_06.png">
</p>
   

<br>
<br>
<br>
   

   

   

#### 전체적인 Train 과정은 다음 그림과 같을 것입니다.

   
<br>
<br>
<br>

<p align="center">
  <img src="/assets/RNN_Doc_Img/pic_07.png">
</p>

<br>
<br>
<br>


* 가장 아래쪽은 입력을 나타냅니다. 각 문자를 One-Hot Encoding해서 입력으로 넣어주고 있습니다.
* RNN 각 Cell에서 해당 문자에 Weight를 곱해서 출력과 함께 다음 Cell로 넘길 값도 계산해 주고 있습니다.
* 출력으로 나온 값은 실제 Target 값과 비교하며 Backpropargation으로 Weight를 조절해 나갑니다.
* 이와 같은 방식으로 Model을 학습시킵니다.

<br>
<br>
<br>   
<br>
<br>
<br>   
<br>
<br>
<br>
   

   

### 3. Application of RNN

* RNN을 이용한 분야는 매우 다양한데, 각각 어떤 분야에서 사용되는지 알아보도록 하겠습니다. 

<br>
<br>
<br>

